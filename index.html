<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FreshShift - Schichtplaner</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Schichtplaner f√ºr Fresh Fries Restaurant - Verf√ºgbarkeiten eintragen und Schichtpl√§ne verwalten">
    <meta name="theme-color" content="#0b5fa5">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="FreshShift">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="FreshShift">
    <meta name="msapplication-TileColor" content="#0b5fa5">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons -->
    <link rel="icon" href="icons/favicon.ico" sizes="any">
    <link rel="icon" type="image/png" sizes="48x48" href="icons/favicon-48.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16.png">
    <link rel="icon" type="image/png" sizes="192x192" href="icons/pwa-icon-192.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="app">
        <!-- Login Screen -->
        <div id="login-screen" class="screen active">
            <div class="login-container">
                <div class="logo">
                    <img src="icons/freshshift-logo-transparent.png" alt="FreshShift" class="brand-logo" />
                    <p>Schichtplaner f√ºr Fresh Fries</p>
                </div>
                
                <div class="login-form">
                    <!-- Login Type Toggle -->
                    <div class="login-toggle">
                        <button class="login-toggle-btn active" data-type="employee">Mitarbeiter</button>
                        <button class="login-toggle-btn" data-type="admin">Admin</button>
                    </div>
                    
                    <!-- Employee Login -->
                    <div id="employee-login" class="login-section active">
                        <div class="login-icon">üë§</div>
                        <p class="login-hint">W√§hle deinen Namen um deine Verf√ºgbarkeit einzutragen oder deinen Schichtplan zu sehen.</p>
                        
                        <div class="form-group">
                            <label for="employee-select">Wer bist du?</label>
                            <select id="employee-select">
                                <option value="">-- Name ausw√§hlen --</option>
                            </select>
                        </div>
                        
                        <button id="login-btn" class="btn btn-primary btn-large btn-full">Anmelden</button>
                    </div>
                    
                    <!-- Admin Login -->
                    <div id="admin-login" class="login-section">
                        <div class="login-icon">üîê</div>
                        <p class="login-hint">Zugang f√ºr Gesch√§ftsleitung zur Schichtplanung und Mitarbeiterverwaltung.</p>
                        
                        <div class="form-group">
                            <label for="admin-password">Passwort</label>
                            <input type="password" id="admin-password" placeholder="Passwort eingeben">
                        </div>
                        
                        <button id="admin-login-btn" class="btn btn-primary btn-large btn-full">Admin-Zugang</button>
                        <p id="admin-error" class="login-error"></p>
                    </div>
                </div>
                
                <p class="login-footer">Fresh Fries Schichtplaner</p>
            </div>
        </div>

        <!-- Employee Dashboard Screen -->
        <div id="dashboard-screen" class="screen">
            <header class="app-header">
                <button id="menu-toggle" class="btn-icon btn-menu">‚ò∞</button>
                <h2>Hallo, <span id="dashboard-user-name"></span></h2>
                <img src="icons/freshshift-icon-transparent.png" alt="FreshShift" class="app-logo-img" />
            </header>
            
            <!-- Slide-out Menu -->
            <div id="menu-overlay" class="menu-overlay"></div>
            <nav id="side-menu" class="side-menu">
                <div class="menu-header">
                    <div class="menu-user-block">
                        <span class="menu-user-name" id="menu-user-name"></span>
                        <div id="menu-user-stores" class="menu-user-stores"></div>
                    </div>
                    <button id="menu-close" class="btn-icon">‚úï</button>
                </div>
                <ul class="menu-list">
                    <li><button class="menu-item active" data-page="dashboard">Startseite</button></li>
                    <li><button class="menu-item" data-page="availability">Verf√ºgbarkeit eintragen</button></li>
                    <li><button class="menu-item" data-page="schedule">Mein Schichtplan</button></li>
                </ul>
                <div class="menu-footer">
                    <button id="menu-logout" class="btn btn-secondary btn-full">Abmelden</button>
                </div>
            </nav>
            
            <div class="container">
                <!-- Dashboard Content -->
                <div id="page-dashboard" class="page-content active">
                    <!-- Today's Shift Card -->
                    <div class="dashboard-card today-card">
                        <div class="card-header">
                            <h3>Heute</h3>
                            <span id="today-date" class="today-date"></span>
                        </div>
                        <div id="today-shift" class="today-shift">
                            <!-- Filled by JS -->
                        </div>
                    </div>
                    
                    <!-- Quick Actions -->
                    <div class="dashboard-card quick-actions-card">
                        <h3>Schnellaktionen</h3>
                        <div class="quick-action-buttons">
                            <button id="btn-late" class="quick-action-btn late">
                                <span class="action-icon">‚è∞</span>
                                <span class="action-text">Ich komme zu sp√§t</span>
                            </button>
                            <button id="btn-early" class="quick-action-btn early">
                                <span class="action-icon">üö™</span>
                                <span class="action-text">Fr√ºher Feierabend</span>
                            </button>
                        </div>
                    </div>

                    <!-- Shift Requests -->
                    <div id="shift-requests-card" class="dashboard-card" style="display:none;">
                        <div class="card-header">
                            <h3>Schichtanfragen</h3>
                            <span id="shift-requests-count" class="week-badge"></span>
                        </div>
                        <div id="shift-requests-list" class="requests-list"></div>
                    </div>
                     
                    <!-- Week Overview -->
                    <div class="dashboard-card week-card">
                        <div class="card-header">
                            <h3>Diese Woche</h3>
                            <span id="dashboard-week" class="week-badge"></span>
                        </div>
                        <div id="week-overview" class="week-overview">
                            <!-- Filled by JS -->
                        </div>
                        <div class="week-stats">
                            <div class="stat">
                                <span id="stat-shifts" class="stat-number">0</span>
                                <span class="stat-label">Schichten</span>
                            </div>
                            <div class="stat">
                                <span id="stat-hours" class="stat-number">0h</span>
                                <span class="stat-label">Stunden</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Next Shifts -->
                    <div class="dashboard-card upcoming-card">
                        <h3>N√§chste Schichten</h3>
                        <div id="upcoming-shifts" class="upcoming-shifts">
                            <!-- Filled by JS -->
                        </div>
                    </div>
                </div>
                
                <!-- Availability Page -->
                <div id="page-availability" class="page-content">
                    <div class="page-header">
                        <h3>Verf√ºgbarkeit eintragen</h3>
                    </div>
                    <div class="store-row" id="employee-store-row" style="display:none;">
                        <label for="employee-store-select" class="store-label">Gesch√§ft</label>
                        <select id="employee-store-select" class="store-select"></select>
                    </div>
                    <div class="week-selector">
                        <button id="prev-week" class="btn-icon">‚Üê</button>
                        <span id="week-display">KW 1</span>
                        <button id="next-week" class="btn-icon">‚Üí</button>
                    </div>
                    
                    <form id="availability-form">
                        <div class="days-container">
                            <!-- Days will be generated by JavaScript -->
                        </div>
                        
                        <div class="form-group notes-group">
                            <label for="general-notes">Allgemeine Bemerkungen</label>
                            <textarea id="general-notes" placeholder="z.B. 'Ab dem 22.12. wie Maria'"></textarea>
                        </div>
                        
                        <button type="submit" class="btn btn-primary btn-large btn-full">Verf√ºgbarkeit speichern</button>
                    </form>
                </div>
                
                <!-- Schedule Page -->
                <div id="page-schedule" class="page-content">
                    <div class="page-header">
                        <h3>Mein Schichtplan</h3>
                    </div>
                    <div class="store-row" id="my-store-row" style="display:none;">
                        <label for="my-store-select" class="store-label">Gesch√§ft</label>
                        <select id="my-store-select" class="store-select"></select>
                    </div>
                    <div class="week-selector">
                        <button id="my-prev-week" class="btn-icon">‚Üê</button>
                        <span id="my-week-display">KW 1</span>
                        <button id="my-next-week" class="btn-icon">‚Üí</button>
                    </div>
                    
                    <div id="schedule-status" class="schedule-status"></div>
                    <div id="my-schedule-content" class="my-schedule-content"></div>
                    <div id="weekly-summary" class="weekly-summary"></div>
                </div>
            </div>
        </div>
        
        <!-- Report Late Modal -->
        <div id="late-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Versp√§tung melden</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <p class="modal-info">Deine Meldung wird sofort an die Gesch√§ftsleitung gesendet.</p>
                    
                    <div class="form-group">
                        <label for="late-minutes">Wie viel Minuten sp√§ter?</label>
                        <select id="late-minutes">
                            <option value="5">5 Minuten</option>
                            <option value="10">10 Minuten</option>
                            <option value="15" selected>15 Minuten</option>
                            <option value="20">20 Minuten</option>
                            <option value="30">30 Minuten</option>
                            <option value="45">45 Minuten</option>
                            <option value="60">1 Stunde</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="late-reason">Grund (optional)</label>
                        <input type="text" id="late-reason" placeholder="z.B. Bahn ausgefallen">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary modal-cancel">Abbrechen</button>
                    <button class="btn btn-warning" id="submit-late">Meldung senden</button>
                </div>
            </div>
        </div>
        
        <!-- Early Leave Modal -->
        <div id="early-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Fr√ºher Feierabend</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <p class="modal-info">Melde, dass du heute fr√ºher gehst.</p>
                    
                    <div class="form-group">
                        <label for="early-minutes">Wie viel Minuten fr√ºher?</label>
                        <select id="early-minutes">
                            <option value="15">15 Minuten</option>
                            <option value="30" selected>30 Minuten</option>
                            <option value="45">45 Minuten</option>
                            <option value="60">1 Stunde</option>
                            <option value="90">1,5 Stunden</option>
                            <option value="120">2 Stunden</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="early-reason">Grund (optional)</label>
                        <input type="text" id="early-reason" placeholder="z.B. Nichts los">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary modal-cancel">Abbrechen</button>
                    <button class="btn btn-primary" id="submit-early">Meldung senden</button>
                </div>
            </div>
        </div>

        <!-- Shift Request Decline Modal -->
        <div id="shift-request-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Schichtanfrage ablehnen</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <p id="shift-request-summary" class="modal-info"></p>
                    <div class="form-group">
                        <label for="shift-request-reason">Grund</label>
                        <input type="text" id="shift-request-reason" placeholder="z.B. Schon verplant / Termin" />
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary modal-cancel">Abbrechen</button>
                    <button class="btn btn-danger" id="submit-request-decline">Ablehnen</button>
                </div>
            </div>
        </div>

        <!-- Admin Screen -->
        <div id="admin-screen" class="screen">
            <header class="app-header">
                <button id="admin-menu-toggle" class="btn-icon btn-menu">‚ò∞</button>
                <h2 class="admin-title"><img src="icons/freshshift-icon-transparent.png" alt="FreshShift" class="app-logo-img small" /> FreshShift Admin</h2>
                <div class="header-actions">
                    <select id="admin-store-select" class="store-select"></select>
                    <div id="notification-badge" class="notification-badge" style="display:none;">
                        <span id="notification-count">0</span>
                    </div>
                </div>
            </header>
            
            <!-- Admin Slide-out Menu -->
            <div id="admin-menu-overlay" class="menu-overlay"></div>
            <nav id="admin-side-menu" class="side-menu admin-menu">
                <div class="menu-header">
                    <span class="menu-user-name">Admin</span>
                    <button id="admin-menu-close" class="btn-icon">‚úï</button>
                </div>
                <ul class="menu-list">
                    <li><button class="menu-item active" data-page="admin-dashboard">√úbersicht</button></li>
                    <li><button class="menu-item" data-page="admin-planner">Wochenplan</button></li>
                    <li><button class="menu-item" data-page="admin-availability">Verf√ºgbarkeiten</button></li>
                    <li><button class="menu-item" data-page="admin-month">Monatsstatistik</button></li>
                    <li><button class="menu-item" data-page="admin-employees">Mitarbeiter</button></li>
                    <li><button class="menu-item" data-page="admin-data">Daten</button></li>
                </ul>
                <div class="menu-footer">
                    <button id="admin-menu-logout" class="btn btn-secondary btn-full">Abmelden</button>
                </div>
            </nav>
            
            <div class="container">
                <!-- Admin Dashboard Page -->
                <div id="page-admin-dashboard" class="page-content active">
                    <!-- Notifications Card -->
                    <div id="notifications-card" class="dashboard-card notifications-card" style="display:none;">
                        <div class="card-header">
                            <h3>Neue Meldungen</h3>
                            <button id="clear-notifications" class="btn btn-small btn-secondary">Gelesen</button>
                        </div>
                        <div id="notifications-list" class="notifications-list-compact"></div>
                    </div>
                    
                    <!-- Week Status Card -->
                    <div class="dashboard-card week-status-card">
                        <div class="card-header">
                            <h3>Diese Woche</h3>
                            <span id="admin-dashboard-week" class="week-badge"></span>
                        </div>
                        <div id="admin-week-status" class="admin-week-status"></div>
                        <div id="admin-week-overview" class="admin-week-overview"></div>
                        <div class="admin-quick-actions">
                            <button id="quick-edit-plan" class="btn btn-primary btn-full">Wochenplan bearbeiten</button>
                        </div>
                    </div>
                    
                    <!-- Today's Shifts Card -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3>Heute arbeiten</h3>
                            <span id="admin-today-date" class="today-badge"></span>
                        </div>
                        <div id="admin-today-shifts" class="today-shifts-list"></div>
                    </div>
                    
                    <!-- Upcoming Absences Card -->
                    <div id="admin-absences-card" class="dashboard-card absences-card">
                        <div class="card-header">
                            <h3>Abwesenheiten</h3>
                            <span class="card-subtitle">N√§chste 14 Tage</span>
                        </div>
                        <div id="admin-upcoming-absences" class="admin-absences-list"></div>
                    </div>
                    
                    <!-- Missing Availabilities Warning -->
                    <div id="missing-avail-card" class="dashboard-card warning-card" style="display:none;">
                        <div class="card-header">
                            <h3>‚ö†Ô∏è Fehlende Verf√ºgbarkeiten</h3>
                            <span id="next-week-badge" class="week-badge">N√§chste Woche</span>
                        </div>
                        <div id="missing-avail-list" class="missing-avail-list"></div>
                    </div>
                    
                    <!-- Quick Stats -->
                    <div class="dashboard-card stats-card">
                        <h3>Schnell√ºbersicht</h3>
                        <div class="admin-stats-grid">
                            <div class="admin-stat">
                                <span id="stat-total-employees" class="stat-number">0</span>
                                <span class="stat-label">Mitarbeiter</span>
                            </div>
                            <div class="admin-stat">
                                <span id="stat-week-shifts" class="stat-number">0</span>
                                <span class="stat-label">Schichten/Woche</span>
                            </div>
                            <div class="admin-stat">
                                <span id="stat-week-hours" class="stat-number">0h</span>
                                <span class="stat-label">Stunden/Woche</span>
                            </div>
                            <div class="admin-stat">
                                <span id="stat-availabilities" class="stat-number">0</span>
                                <span class="stat-label">Verf√ºgbarkeiten</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Planner Page -->
                <div id="page-admin-planner" class="page-content">
                    <div class="page-header">
                        <h3>Wochenplan erstellen</h3>
                    </div>
                    
                    <div class="week-selector">
                        <button id="admin-prev-week" class="btn-icon">‚Üê</button>
                        <span id="admin-week-display">KW 1</span>
                        <button id="admin-next-week" class="btn-icon">‚Üí</button>
                    </div>
                    
                    <div class="planner-actions">
                        <button id="copy-last-week" class="btn btn-secondary">
                            <span class="btn-icon-inline">üìã</span> Letzte Woche kopieren
                        </button>
                        <button id="print-schedule" class="btn btn-secondary">
                            <span class="btn-icon-inline">üñ®Ô∏è</span> Drucken / PDF
                        </button>
                        <button id="save-schedule" class="btn btn-primary">Speichern</button>
                        <button id="release-schedule" class="btn btn-success" disabled>Freigeben</button>
                    </div>

                    <div class="print-header">
                        <div class="print-brand">
                            <img src="icons/freshshift-logo-transparent.png" alt="FreshShift" class="print-logo" />
                            <div class="print-meta">
                                <div class="print-title">Wochenplan</div>
                                <div id="print-week" class="print-week"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mobile: Day-by-day cards -->
                    <div id="planner-mobile" class="planner-mobile"></div>
                    
                    <!-- Desktop: Table view -->
                    <div class="planner-desktop">
                        <div class="schedule-editor">
                            <table id="schedule-table" class="schedule-table"></table>
                        </div>
                    </div>
                    
                    <div id="week-deviations-panel" class="week-summary-panel">
                        <h4>Abweichungen</h4>
                        <div id="week-deviations" class="deviations-list"></div>
                    </div>
                </div>
                
                <!-- Availability Overview Page -->
                <div id="page-admin-availability" class="page-content">
                    <div class="page-header">
                        <h3>Wer kann wann?</h3>
                    </div>
                    
                    <div class="week-selector">
                        <button id="avail-prev-week" class="btn-icon">‚Üê</button>
                        <span id="avail-week-display">KW 1</span>
                        <button id="avail-next-week" class="btn-icon">‚Üí</button>
                    </div>
                    
                    <!-- Mobile: Cards per employee -->
                    <div id="availability-mobile" class="availability-mobile"></div>
                    
                    <!-- Desktop: Table -->
                    <div class="availability-desktop">
                        <div class="availability-overview">
                            <table id="availability-table" class="overview-table"></table>
                        </div>
                    </div>
                </div>
                
                <!-- Month Stats Page -->
                <div id="page-admin-month" class="page-content">
                    <div class="page-header">
                        <h3>Monatsstatistik</h3>
                    </div>
                    
                    <div class="month-selector">
                        <button id="prev-month" class="btn-icon">‚Üê</button>
                        <span id="month-display">Januar 2025</span>
                        <button id="next-month" class="btn-icon">‚Üí</button>
                    </div>
                    
                    <!-- Mobile: Cards -->
                    <div id="month-stats-mobile" class="month-stats-mobile"></div>
                    
                    <!-- Desktop: Table -->
                    <div class="month-stats-desktop">
                        <div class="month-overview">
                            <table id="month-table" class="month-table">
                                <thead>
                                    <tr>
                                        <th>Mitarbeiter</th>
                                        <th>Geplant</th>
                                        <th>Tats√§chlich</th>
                                        <th>+/-</th>
                                        <th>Sp√§t</th>
                                        <th>Fr√ºh</th>
                                    </tr>
                                </thead>
                                <tbody id="month-table-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Employees Page -->
                <div id="page-admin-employees" class="page-content">
                    <div class="page-header-with-action">
                        <h3>Mitarbeiter verwalten</h3>
                        <button id="add-employee-btn" class="btn btn-primary btn-small">+ Neu</button>
                    </div>
                    <div id="employees-list" class="employees-list-admin"></div>
                    
                    <!-- Upcoming Absences -->
                    <div class="dashboard-card absences-overview-card">
                        <div class="card-header">
                            <h3>Kommende Abwesenheiten</h3>
                        </div>
                        <div id="absences-overview-list" class="absences-list"></div>
                    </div>
                </div>

                <!-- Data Page (Backup/Import) -->
                <div id="page-admin-data" class="page-content">
                    <div class="page-header">
                        <h3>Daten</h3>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3>Backup exportieren</h3>
                            <span id="backup-status" class="today-badge"></span>
                        </div>
                        <p class="helper-text">Exportiert Mitarbeiter, Verf√ºgbarkeiten, Wochenpl√§ne, Abwesenheiten und Meldungen als JSON-Datei.</p>
                        <button id="export-data" class="btn btn-primary">Backup herunterladen</button>
                    </div>

                    <div class="dashboard-card warning-card">
                        <div class="card-header">
                            <h3>Backup importieren</h3>
                        </div>
                        <p class="helper-text">Achtung: Import √ºberschreibt die aktuellen Daten auf diesem Ger√§t.</p>
                        <div class="form-group">
                            <label for="import-file">JSON-Datei ausw√§hlen</label>
                            <input id="import-file" type="file" accept="application/json">
                        </div>
                        <div class="form-actions">
                            <button id="import-data" class="btn btn-warning">Importieren</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Shift Modal (Admin) -->
        <div id="shift-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Schicht bearbeiten</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="modal-day-info" class="modal-day-info"></div>
                    
                    <div class="available-employees">
                        <h4>Verf√ºgbarkeit:</h4>
                        <div id="available-list"></div>
                    </div>
                    
                    <div class="shift-times">
                        <h4>Schichtzeiten:</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="shift-start">Geplant von</label>
                                <input type="time" id="shift-start" value="10:00" step="60" class="time-input-24h">
                            </div>
                            <div class="form-group">
                                <label for="shift-end">Geplant bis</label>
                                <input type="time" id="shift-end" value="20:00" step="60" class="time-input-24h">
                            </div>
                        </div>
                        
                        <div class="actual-times">
                            <h4>Tats√§chliche Zeiten (falls abweichend):</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="actual-start">Tats√§chlich von</label>
                                    <input type="time" id="actual-start" step="60" class="time-input-24h">
                                </div>
                                <div class="form-group">
                                    <label for="actual-end">Tats√§chlich bis</label>
                                    <input type="time" id="actual-end" step="60" class="time-input-24h">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="deviation-note">Bemerkung</label>
                                <input type="text" id="deviation-note" placeholder="z.B. 'Fr√ºher gegangen, nichts los'">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary modal-cancel">Abbrechen</button>
                    <button class="btn btn-danger" id="remove-shift" style="display:none;">Entfernen</button>
                    <button class="btn btn-primary" id="save-shift">Speichern</button>
                </div>
            </div>
        </div>
        
        <!-- Add Employee Modal -->
        <div id="add-employee-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="employee-modal-title">Mitarbeiter</h3>
                    <button class="modal-close">&times;</button>
                </div>
                    <div class="modal-body">
                        <input type="hidden" id="new-emp-id" value="">
                        <div class="form-group">
                        <label for="new-emp-name">Name</label>
                        <input type="text" id="new-emp-name" placeholder="Name eingeben">
                    </div>
                    <div class="form-group">
                        <label for="new-emp-type">Typ</label>
                        <select id="new-emp-type">
                            <option value="aushilfe">Aushilfe</option>
                            <option value="festangestellt">Festangestellt</option>
                        </select>
                        <div class="form-group">
                            <label>Gesch√§ft(e)</label>
                            <div class="store-checkboxes">
                                <label class="checkbox-pill"><input type="checkbox" id="store-fresh-fries" value="fresh_fries"> Fresh Fries</label>
                                <label class="checkbox-pill"><input type="checkbox" id="store-yes-fresh" value="yes_fresh"> Yes Fresh</label>
                            </div>
                        </div>
                        <div class="form-group" id="new-emp-primary-store-group" style="display:none;">
                            <label for="new-emp-primary-store">Hauptgesch√§ft</label>
                            <select id="new-emp-primary-store"></select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary modal-cancel">Abbrechen</button>
                    <button class="btn btn-primary" id="save-new-employee">Speichern</button>
                </div>
            </div>
        </div>
        
        <!-- Copy Week Modal -->
        <div id="copy-week-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Woche kopieren</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <p id="copy-week-summary" class="modal-info"></p>
                    <div id="copy-week-conflicts" class="conflicts-list"></div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary modal-cancel">Abbrechen</button>
                    <button class="btn btn-secondary" id="copy-week-skip">Ohne Konflikte kopieren</button>
                    <button class="btn btn-primary" id="copy-week-all">Trotzdem alles kopieren</button>
                </div>
            </div>
        </div>

        <!-- Absence Modal (Urlaub/Krankheit) -->
        <div id="absence-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="absence-modal-title">Abwesenheit eintragen</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="absence-employee-info" class="modal-day-info"></div>
                    
                    <div class="form-group">
                        <label for="absence-type">Art der Abwesenheit</label>
                        <select id="absence-type">
                            <option value="urlaub">Urlaub</option>
                            <option value="krank">Krankheit</option>
                            <option value="sonstiges">Sonstiges</option>
                        </select>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="absence-start">Von</label>
                            <input type="date" id="absence-start">
                        </div>
                        <div class="form-group">
                            <label for="absence-end">Bis</label>
                            <input type="date" id="absence-end">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="absence-note">Bemerkung (optional)</label>
                        <input type="text" id="absence-note" placeholder="z.B. Familienurlaub">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary modal-cancel">Abbrechen</button>
                    <button class="btn btn-danger" id="delete-absence" style="display:none;">L√∂schen</button>
                    <button class="btn btn-primary" id="save-absence">Speichern</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container"></div>

    <script src="js/data.js"></script>
    <script src="js/app.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then((registration) => {
                        console.log('SW registered:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New content available, show update notification
                                    if (confirm('Neue Version verf√ºgbar! Jetzt aktualisieren?')) {
                                        newWorker.postMessage({ type: 'SKIP_WAITING' });
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.log('SW registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
